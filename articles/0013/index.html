<table align="center"
	style="border-top-width: 0px; border-left-width: 0px; width: 95%;">
	<tbody>
		<tr>
			<td>
			<h2 align="left">Integrating CruiseControl and ClearCase</h2>
			<p align="justify"><i>A brief introduction on configuring
			CruiseControl to work with ClearCase</i></p>
			<h3>Introduction</h3>
			<p align="justify">CruiseControl is a &quot;framework for a
			continuous build process&quot; that allows you to automate the
			execution of your builds and report on their results. See <a
				href="http://www.buildmeister.com/modules/content/index.php?id=9">here</a>
			for a brief overview on CruiseControl. In this article we will
			discuss how to configure CruiseControl to work with IBM Rational
			ClearCase - the most popular commercial Software Configuration
			Management tool. We will be using ClearCase snapshot views, rather
			than dynamic views, for better build performance and because they
			suit the build environment of CruiseControl slightly better.</p>
			<p align="justify">We will assume that we are building a project
			called <i>Example</i> and that a snapshot build view has already been
			created for this project, called <font face="Courier New">C:\Views\Example_build</font>;
			finally we will also assume that there is an integration branch or
			stream called <font face="Courier New">Example_Int</font> in this
			project which we are going to monitor for changes. I will be using
			UCM for creating baselines but the principles can easily be mapped to
			Base ClearCase labels instead.</p>
			<h3 align="justify">Configure project build file</h3>
			<p align="justify">My preference is to develop a single project <font
				face="Courier New">build.xml</font> file that can be used by anyone:
			developers, release engineers or automatically invoked by
			CruiseControl. I believe this is better than maintaining a separate
			CruiseControl <font face="Courier New"><i>project</i>-build.xml
			</font>file which calls the original <font face="Courier New">build.xml</font>
			file. An example of the additional entries I would put into a project
			<font face="Courier New">build.xml </font>file for CruiseControl are
			as follows:</p>
			<table width="733" height="700" cellspacing="0" cellpadding="0"
				bordercolor="#111111" border="0" style="border-collapse: collapse;"
				id="AutoNumber3">
				<tbody>
					<tr>
						<td width="67" height="700">
						<blockquote style="margin-right: 0px;" dir="ltr">
						<p><font face="Courier New" color="#008080">01: <br />
						02: <br />
						03: <br />
						04: <br />
						05: <br />
						06: <br />
						07: <br />
						08: <br />
						09: <br />
						10: <br />
						11: <br />
						12: <br />
						13: <br />
						14: <br />
						15: <br />
						16: <br />
						17: <br />
						18: <br />
						19: <br />
						20: <br />
						21: <br />
						22: <br />
						23: <br />
						24: <br />
						25: <br />
						26: <br />
						27: <br />
						28: <br />
						29: <br />
						30: <br />
						31: <br />
						32: <br />
						33: <br />
						34: <br />
						35: <br />
						36: <br />
						37: <br />
						38: <br />
						39: <br />
						40: <br />
						41: <br />
						42: <br />
						43: <br />
						44: <br />
						45:</font></p>
						</blockquote>
						</td>
						<td width="663" valign="top" height="700">
						<blockquote style="margin-right: 0px;" dir="ltr">
						<p><font face="Courier New"><font color="#808080">&lt;?xml
						version=&quot;1.0&quot;?&gt;<br />
						<br />
						&lt;project name=&quot;RationalBankWeb&quot; <br />
						&nbsp;&nbsp;&nbsp; default=&quot;help&quot; basedir=&quot;.&quot;
						<br />
						&nbsp;&nbsp;&nbsp;
						xmlns:ca=&quot;antlib:com.buildmeister.clearantlib&quot;&gt;<br />
						<br />
						</font><font color="#000080">&lt;!-- ClearCase snapshot view
						update --&gt;</font><font color="#808080"><br />
						&lt;target name=&quot;update-view&quot; <br />
						&nbsp;&nbsp;&nbsp; description=&quot;update ClearCase snapshot
						view&quot;&gt;<br />
						&nbsp;&nbsp;&nbsp; &lt;ca:cleartool
						failonerror=&quot;false&quot;&gt; <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;commandline&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;argument line=&quot;update -force -log NUL .\..\..&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/commandline&gt;<br />
						&nbsp;&nbsp;&nbsp; &lt;/ca:cleartool&gt;<br />
						&lt;/target&gt;<br />
						<br />
						</font><font color="#000080">... other normal project build tasks
						...</font><font color="#808080"><br />
						<br />
						</font><font color="#000080">&lt;!-- CruiseControl Integration
						Build --&gt;</font><font color="#808080"><br />
						&lt;target name=&quot;cc-build&quot; depends=&quot;update-view,
						dist, deploy, javadoc&quot;<br />
						&nbsp;&nbsp;&nbsp; description=&quot;execute a CruiseControl
						Integration build&quot;&gt;<br />
						&nbsp;&nbsp;&nbsp; &lt;ca:cleartool&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#000080">&lt;!--
						create a new baseline --&gt;</font><font color="#808080"><br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;commandline&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;argument value=&quot;mkbl&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;argument value=&quot;-full&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;argument value=&quot;${label}&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/commandline&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#000080">&lt;!--
						promote the baseline --&gt;</font><font color="#808080"><br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;commandline&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;argument value=&quot;chbl&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;argument line=&quot;-level BUILT&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;argument value=&quot;${label}@\\<i><u>ProjectVOB</u></i>&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/commandline&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#000080">&lt;!--
						recommend it in this stream --&gt;</font><font color="#808080"><br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;commandline&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;argument value=&quot;chstream&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;argument value=&quot;-recommend&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;argument value=&quot;${label}@\\<i>ProjectVOB</i>&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;argument value=&quot;Example_Int&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/commandline&gt;<br />
						&nbsp;&nbsp;&nbsp; &lt;/ca:cleartool&gt;<br />
						&lt;/target&gt;<br />
						<br />
						&lt;/project&gt;</font></font></p>
						</blockquote>
						</td>
					</tr>
				</tbody>
			</table>
			<p align="justify">This build file contains two new tasks: <font
				face="Courier New">update-view</font> and <font face="Courier New">cc-build</font>.
			The <font face="Courier New">update-view</font> task obviously brings
			the snapshot view up to date. The <font face="Courier New">cc-build</font>
			target is the one that we will be getting CruiseControl to execute;
			it basically carries out an integration build and test and then puts
			a baseline down on the project files. Note that rather than using the
			ClearCase integration tasks that come with Ant, I am using my own <i>ClearAntLib</i>
			library as it is more flexible. Further details on this library can
			be found <a href="http://sourceforge.net/projects/clearantlib">here</a>.</p>
			<h3 align="justify">Configur CruiseControl config file</h3>
			<p align="justify">Next we need to configure CruiseControl's <font
				face="Courier New">config.xml</font> file to call this build file;
			an example to do this would be as follows:</p>
			<div align="justify">
			<table width="733" height="700" cellspacing="0" cellpadding="0"
				bordercolor="#111111" border="0" style="border-collapse: collapse;"
				id="AutoNumber4">
				<tbody>
					<tr>
						<td width="67" height="700">
						<blockquote style="margin-right: 0px;" dir="ltr">
						<p><font face="Courier New" color="#008080">01: <br />
						02: <br />
						03: <br />
						04: <br />
						05: <br />
						06: <br />
						07: <br />
						08: <br />
						09: <br />
						10: <br />
						11: <br />
						12: <br />
						13: <br />
						14: <br />
						15: <br />
						16: <br />
						17: <br />
						18: <br />
						19: <br />
						20: <br />
						21: <br />
						22: <br />
						23: <br />
						24: <br />
						25: <br />
						26: <br />
						27: <br />
						28: <br />
						29: <br />
						30: <br />
						31: <br />
						32: <br />
						33: <br />
						34: <br />
						35: <br />
						36: <br />
						37: <br />
						38: <br />
						39: <br />
						40: <br />
						41: <br />
						42: <br />
						43: <br />
						44: <br />
						45: <br />
						46: <br />
						47: <br />
						48: <br />
						49: <br />
						50: <br />
						51: <br />
						52:<br />
						53:</font></p>
						</blockquote>
						</td>
						<td width="663" valign="top" height="700">
						<blockquote style="margin-right: 0px;" dir="ltr">
						<p><font face="Courier New" color="#808080">&lt;project
						name=&quot;Example&quot; buildafterfailed=&quot;false&quot;&gt;<br />
						&nbsp;&nbsp;&nbsp; &lt;dateformat format=&quot;dd/MM/yyyy
						HH:mm:ss&quot;/&gt; <br />
						&nbsp;&nbsp;&nbsp; <b>&lt;labelincrementer
						defaultLabel=&quot;EXAMBLD.1&quot; separator=&quot;-&quot;/&gt;</b><br />
						<br />
						&nbsp;&nbsp;&nbsp; &lt;listeners&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;currentbuildstatuslistener <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						file=&quot;logs\Example\buildstatus.txt&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp; &lt;/listeners&gt;<br />
						<br />
						&nbsp;&nbsp;&nbsp; &lt;bootstrappers&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>&lt;clearcasebootstrapper
						<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						file=&quot;build.xml&quot; <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						viewPath=&quot;C:\Views\Example_build\Example&quot;/&gt;</b><br />
						&nbsp;&nbsp;&nbsp; &lt;/bootstrappers&gt;<br />
						<br />
						&nbsp;&nbsp;&nbsp; &lt;modificationset
						requiremodification=&quot;true&quot;
						quietperiod=&quot;60&quot;&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>&lt;clearcase <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						branch=&quot;Example_Int&quot; <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						viewpath=&quot;C:\Views\Example_build\Example&quot; <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						recursive=&quot;true&quot; /&gt;</b><br />
						&nbsp;&nbsp;&nbsp; &lt;/modificationset&gt;<br />
						<br />
						&nbsp;&nbsp;&nbsp; &lt;schedule interval=&quot;600&quot;&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>&nbsp;&lt;ant <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						antscript=&quot;C:\Views\java_tools\JavaTools\bin\ant.bat&quot;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						antWorkingDir=&quot;C:\Views\Example_build\Example&quot;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						buildfile=&quot;C:\Views\Example_build\Example\build.xml&quot;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						uselogger=&quot;true&quot;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						usedebug=&quot;false&quot;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						target=&quot;cc-build&quot;/&gt;</b><br />
						&nbsp;&nbsp;&nbsp; &lt;/schedule&gt;<br />
						<br />
						&nbsp;&nbsp;&nbsp; &lt;log&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;merge <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						file=&quot;C:\Views\Example_build\Example\build\TESTS-*.xml&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp; &lt;/log&gt;<br />
						<br />
						&nbsp;&nbsp;&nbsp; &lt;publishers&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;htmlemail <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						mailhost=&quot;<i>smtp.mailhost.com</i>&quot; <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						returnaddress=&quot;bldadmin&quot;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						spamwhilebroken=&quot;true&quot; <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						subjectprefix=&quot;[CruiseControl]: &quot; <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						buildresultsurl=&quot;http://<i>server</i>/cruisecontrol/buildresults/Example&quot;/&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						xsldir=&quot;<i>\path\to\cruisecontrol\reporting\jsp\xsl</i>&quot;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						css=&quot;<i>\path\to\cruisecontrol\\reporting\jsp\css\cruisecontrol.css</i>&quot;&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;always address=&quot;<i>int-group</i>&quot; /&gt;<br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&lt;failure address=&quot;<i>dev-group</i>&quot; /&gt; <br />
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/htmlemail&gt;<br />
						&nbsp;&nbsp;&nbsp; &lt;/publishers&gt;<br />
						<br />
						&lt;/project&gt;</font></p>
						</blockquote>
						</td>
					</tr>
				</tbody>
			</table>
			</div>
			<p align="justify">There is quite a lot of ClearCase
			configuration in this file, of note are the following:</p>
			<div align="justify">
			<ul type="square">
				<li><i>line 3:</i><br />
				This is where we define the format of the label that CruiseControl
				will automatically create, it will be passed to our project <font
					face="Courier New">build.xml </font>file as <font
					face="Courier New">${label}</font> and will be of the format <font
					face="Courier New">EXAMBLD-1, EXAMBLD-2</font> and so on.</li>
				<li><i>lines 11-13</i>:<br />
				Since we are using a snapshot view and <font face="Courier New">build.xml</font>
				might have changed itself, we need to update this single file before
				running the build.&nbsp;</li>
				<li><i>lines 17-20</i>:<br />
				This is where we define what changes to look for, we will look into
				our pre-configured build view <font face="Courier New">C:\Views\Example_build</font>
				and at the integration branch/stream.</li>
				<li><i>lines 23-31</i>:<br />
				We will invoke the build, if something has changed, every 10
				minutes. We will do this by going down into our build view and
				executing Ant on the target <font face="Courier New">cc-build</font>
				that we created earlier on.</li>
			</ul>
			<p align="justify">The remaining lines are standard CruiseControl
			configuration, irrespective of ClearCase.</p>
			</div>
			<div align="justify">
			<h3 align="justify">In Use</h3>
			</div>
			<div align="justify">
			<p align="justify">This is really an example of some basic
			configuration, enough to get you up and running with CruiseControl.
			In reality you might want to schedule nightly builds as well as
			modification builds, you might only want to promote the baseline if
			the build actually works and so on. As a word of caution, you might
			not want to create a new UCM baseline every build as too many
			baselines can potentially slow down ClearCase; either clean out old
			baselines or only put the baselines down infrequently.</p>
			</div>
			<div align="justify">
			<p align="justify">There are lots of additional features of
			ClearCase that you can potentially use here to get a really good
			build environment up and running. I hope this example has wet your
			appetite.</p>
			</div>
			<h3>References</h3>
			<ul>
				<li><a
					href="http://www.amazon.com/gp/product/0321356993/qid=1133710512/sr=1-5/ref=sr_1_5/104-1622633-2035145?s=books&amp;v=glance&amp;n=283155">ClearCase,
				Ant, and CruiseControl : The Java Developer's Guide to Accelerating
				and Automating the Build Process</a> [Lee]</li>
				<li><a href="http://cruisecontrol.sourceforge.net/">CruiseControl
				home page</a></li>
				<li><a
					href="http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET">CruiseControl.NET
				home page</a></li>
			</ul>
			</td>
		</tr>
	</tbody>
</table>
<center></center>