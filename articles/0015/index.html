<div id="article">
<h1>Introduction to Apache Maven</h1>
<p id="articlehead">A brief introduction to the features and
capabilities of Apache Maven  -  a Java build and project
management tool.</p>
<h2>Introduction</h2>
<p>Apache Maven is an interesting and relatively new Java-based
build tool. From a build scripting point of view, Maven can be seen as a
potential replacement for <a
	href="viewarticle.php?id=1">Apache
Ant</a>. The main difference  is that rather than specifying a detailed
set of build commands (as in an Ant script), Maven follows a more rule
or goal-based approach. Most of the goals that you would typically
require when building a Java project, i.e., compiling, testing, creating
distribution archives and so on are already embedded in Maven's project
lifecycle. The main advantage of this approach is that there is
potentially significantly less scripting required to implement a build
process.</p>
<p>Maven also has advanced build project management capabilities.
This includes the capability for specifying and resolving Java
library dependencies from a central project repository (something which
can rapidly become overwhelming in any large scale Java project). As
well as automatically generating project documentation (code style
reports, metrics, developer activity, change logs) and ultimately the
construction of a complete project web site.</p>
<p>There are two versions of Apache Maven: <a
	href="http://maven.apache.org/maven-1.x/">Maven 1</a> and <a
	href="http://maven.apache.org/">Maven 2</a> both of which have
significantly different code bases and implementation details. Maven 1
is in maintenance mode (no new features are being added), therefore this
article will concentrate on discussing Apache Maven 2.</p>
<div id="keyconcepts">
<p align="center"><b><u>Key Concepts</u></b></p>
<p><b>repository</b> - a local or central repository of dependent
Java archives.</p>
<p><b>project object model (POM)</b> - a description of the project
to be built, its contributers, dependencies and reports..</p>
<p><b>goals</b> - a discrete part of an end-to-end build process,
i.e. compile, test, package.</p>
<p><b>dependencies</b> - the set of Java libraries (and their
versions) that are required to build a project.</p>
<p><span style="font-weight: bold;">transitive dependencies</span> -
the dependencies of dependencies, i.e. if you require a library X at
version 1 it requires (and resolves itself) any other libraries it
needs.</p>
</div>
<p>Maven has a number of concepts which it is worth discussing and
understanding as follows:</p>
<ul>
	<li><b>The repository </b></li>
</ul>
<blockquote dir="ltr" style="margin-right: 0px;">
<p>One of the main differences between Apache Maven and other build
tools is that Maven maintains a  repository of dependent Java
archives for <span style="text-decoration: underline;">each</span> user.
What this means is that when you run Maven and require specific versions
of Java libraries to build against, Maven checks for the existence
of these libraries from a <span style="font-weight: bold;">central
repository</span> and downloads them to your own <span
	style="font-weight: bold;">local repository</span>. By default, this
central repository is hosted on the Internet at <a
	href="http://www.ibiblio.org/maven2">http://www.ibiblio.org/maven2</a>
- which means that you will require an Internet connection for for
downloads to occur successfully, however, for more secure
environments you can also create a central repository on your
organizations Intranet..</p>
</blockquote>
<ul>
	<li><b>Configuration files </b></li>
</ul>
<blockquote dir="ltr" style="margin-right: 0px;">
<p>Maven uses a number of configuration files to manage its
environment and execution as follows:</p>
<blockquote dir="ltr" style="margin-right: 0px;">
<p><font face="Courier New">- pom.xml</font><br />
The <font face="Courier New">pom.xml </font>file is required for each
project being built and it is where you place the description of the
project in what Maven calls Project Object Model (POM) format. Maven
sometimes refers to this file as the <span style="font-weight: bold;">project
descriptor</span>. <br />
</p>
<p><font face="Courier New">- settings.xml</font><br />
The <font face="Courier New">settings.xml</font> file
contains property values for Maven and its plug-ins, it is usually
used to override specific settings in the <font face="Courier New">pom.xml</font>
file.  It is usually created by individual users when they want to
override settings.</p>
<p>- <span style="font-family: monospace;">profiles.xml</span><br />
The <span style="font-family: monospace;">profiles.xml</span> file
contains grouping of properties that can be applied to a build
execution, for example an integration build, release build, deployment
to UAT build and so on.</p>
</blockquote>
</blockquote>
<ul>
	<li><b>Goals </b></li>
</ul>
<blockquote dir="ltr" style="margin-right: 0px;">
<p>In a similar way that you execute targets via Ant, i.e. <font
	face="Courier New">ant compile</font>, with Maven you execute goals,
i.e. <font face="Courier New">mvn compile</font>. The main difference is
that with Ant you have to define these targets yourself in the <font
	face="Courier New">build.xml</font> file, whereas with Maven a large
number of them are already pre-defined as part of a standard &quot;build
lifecycle&quot;. These pre-defined goals encompass a large part of the
build process from compilation to distribution, to deployment and
documentation.  If you still need to create custom goals then you
can also create custom plugins (see below) that implement a
discrete set of operations (Maven calls these goals its
&quot;Mojo&quot;) and bind them to part of the build lifecycle in the <font
	face="Courier New">pom.xml</font> file.</p>
</blockquote>
<ul>
	<li><b>Plugins</b></li>
</ul>
<blockquote dir="ltr" style="margin-right: 0px;">
<p>Maven is built from a small core extended by plug-ins; a
comprehensive number of plug-ins are already distributed or
automatically downloaded with Maven but there are more that are
available that are not part of the standard distribution. Plugins allow
for the reuse of common build logic across multiple projects. They do
this by executing an &quot;action&quot; (i.e. creating a Java Web
archive or executing JUnit tests) in the context of the Project's
Object Model. Plugin behavior can be customized through a set of unique
parameters which are exposed by a description of each plugin goal.</p>
</blockquote>
<h2>An Example</h2>
<p>An example of an Maven <span style="font-family: monospace;">pom.xml</span>
file to build a set of Java classes (for the <a
	href="http://hoteldejava.sourceforge.net/">Hotel de Java</a>
application web front end) is given below::</p>
<pre name="code" class="xml">
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0
    http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;net.sourceforge.hdjweb&lt;/groupId&gt;
    &lt;artifactId&gt;HDJWeb&lt;/artifactId&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;
    &lt;version&gt;1.0-alpha-1&lt;/version&gt;
    &lt;name&gt;HDJWeb&lt;/name&gt;
    &lt;url&gt;http://hoteldejava.sourceforge.net&lt;/url&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;      
            &lt;groupId&gt;net.sourceforge.hoteldj.ejb&lt;/groupId&gt;
            &lt;artifactId&gt;HDJEJB&lt;/artifactId&gt;
            &lt;version&gt;1.0-alpha-1&lt;/version&gt;
            &lt;type&gt;ejb&lt;/type&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;sourceDirectory&gt;src&lt;/sourceDirectory&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;webResources&gt;
                        &lt;resource&gt;
                            &lt;directory&gt;${project.basedir}/WebContent&lt;/directory&gt;
                            &lt;includes&gt;
                                &lt;include&gt;**/*.jsp&lt;/include&gt;
                                &lt;include&gt;theme/*&lt;/include&gt;
                                &lt;include&gt;WEB-INF/geronimo*.xml&lt;/include&gt;
                                &lt;include&gt;WEB-INF/web.xml&lt;/include&gt;
                            &lt;/includes&gt;
                        &lt;/resource&gt;
                    &lt;/webResources&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;scm&gt;
        &lt;connection&gt;         
            scm:svn:https://hoteldejava.svn.buildmeister.net/svnroot/hoteldejava
        &lt;/connection&gt;
        &lt;developerConnection&gt;
            scm:svn:https://hoteldejava.svn.buildmeister.net/svnroot/hoteldejava
        &lt;/developerConnection&gt;
        &lt;tag&gt;HEAD&lt;/tag&gt;
        &lt;url&gt;
            http://hoteldejava.svn.buildmeister.net/viewvc/hoteldejava/
        &lt;/url&gt;
    &lt;/scm&gt;

    &lt;reporting&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;
                    maven-project-info-reports-plugin
                &lt;/artifactId&gt;     
                &lt;reportSets&gt;
                    &lt;reportSet&gt;
                        &lt;reports&gt;
                            &lt;report&gt;dependencies&lt;/report&gt;
                            &lt;report&gt;project-team&lt;/report&gt;
                            &lt;report&gt;mailing-list&lt;/report&gt;
                            &lt;report&gt;issue-tracking&lt;/report&gt;
                            &lt;report&gt;license&lt;/report&gt;
                            &lt;report&gt;scm&lt;/report&gt;
                        &lt;/reports&gt;
                    &lt;/reportSet&gt;
                &lt;/reportSets&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/reporting&gt;

&lt;/project&gt;
</pre>
<p>If this file was used to build the application then the
output result would look similar to the following:</p>
<div id="codeoutput">
<p><b>&gt;mvn package</b><br />
[INFO] Scanning for projects...<br />
[INFO]
-------------------------------------------------------------------------<br />
---<br />
[INFO] Building HDJWeb<br />
[INFO]    task-segment: [package]<br />
[INFO]
-------------------------------------------------------------------------<br />
---<br />
Downloading:
http://repo1.maven.org/maven2/junit/junit/3.8.1/junit-3.8.1.pom<br />
998b downloaded<br />
...<br />
[INFO] [resources:resources]<br />
[INFO] Using default encoding to copy filtered resources.<br />
[INFO] [compiler:compile]<br />
[INFO] Compiling 10 source files to C:\Builds\HDJWeb\target\classes<br />
[INFO] [resources:testResources]<br />
[INFO] Using default encoding to copy filtered resources.<br />
[INFO] [compiler:testCompile]<br />
[INFO] No sources to compile<br />
[INFO] [surefire:test]<br />
[INFO] No tests to run.<br />
[INFO] [war:war]<br />
[INFO] Exploding webapp...<br />
[INFO] Assembling webapp HDJWeb
in C:\Builds\HDJWeb\target\HDJWeb-1.0-alpha-1<br />
[INFO] Copy webapp webResources
to C:\Builds\HDJWeb\target\HDJWeb-1.0-alpha-1<br />
[INFO] Copy webapp webResources
to C:\Builds\HDJWeb\target\HDJWeb-1.0-alpha-1<br />
[INFO] Generating
war C:\Builds\HDJWeb\target\HDJWeb-1.0-alpha-1.war<br />
[INFO] Building war: C:\Builds\HDJWeb\target\HDJWeb-1.0-alpha-1.war<br />
[INFO]
------------------------------------------------------------------------<br />
[INFO] BUILD SUCCESSFUL<br />
[INFO]
------------------------------------------------------------------------<br />
[INFO] Total time: 4 seconds<br />
[INFO] Finished at: Tue Jul 31 10:21:33 BST 2007<br />
[INFO] Final Memory: 5M/10M<br />
[INFO]
------------------------------------------------------------------------<br />
</p>
</div>
<p>In this build script a Web archive called <span
	style="font-weight: bold;">HDJWeb-1.0-alpha-1</span><b>.jar</b> will be
built. This version number is managed by Maven and is used so that
different Java library versions can be stored in the repository for
different projects. When you first start a Maven build a large number of
plugins will be downloaded to your local repository (in this example you
can see that information about JUnit is being downloaded). Note that
unlike Ant, the <span style="font-family: monospace;">pom.xml</span>
file does not need to specify the details of how to compile and package
your application. - Maven knows how to do this automatically. Instead
the <span style="font-family: monospace;">pom.xml</span> file describes
information about the project, its build time dependencies and the
configuration of any plugins that are to be executed.</p>
<p>In more detail example the first part of the <font
	face="Courier New">pom.xml</font> file, lines 1-11 defines some basic
information about the project and the organization developing
it. Lines 13-20 specify the list of third party and internally
developed libraries that this project is dependent upon, in the case
version 1.0-alpha-1 of <span style="font-weight: bold;">HDJEJB</span>
This information is used to download the specific version of this
library from the central repository for building against.</p>
Lines 22-43 illustrate how you can configure Maven's plugins. In
this case the <a
	href="http://maven.apache.org/plugins/maven-war-plugin/">maven-war-plugin</a>
is being configured to point to the locations of the applications web
resources. If your applications directory structure was implemented
exactly as the maven-war-plugin expects then there would be no need for
this section. However with the use of IDEs and existence of legacy
applications you sometimes do not get a choice in this matter.
Configuring any of Maven's other core and contributed plugins works in
exactly the same way. Note that when the Maven build was executed the <span
	style="font-weight: bold;">package</span> goal for the application was
specified, since the packaging type is specified on line 8, Maven knows
to call that maven-war-plugin rather than the <a
	href="http://maven.apache.org/plugins/maven-jar-plugin/">maven-jar-plugin</a>
for example.<br />
<p>Lines 45-56 specifies the SCM connection that is to be used for
the project - in this case Subversion. This information is used by
plugins which require SCM repository information, such as the <a
	href="http://maven.apache.org/plugins/maven-release-plugin/index.html">maven-release-plugin</a>
which can be used to prepare and perform a release. It is also used to
populate some of the reports that Maven can automatically
generate.  </p>
<p>Reporting is one of Maven's most powerful capabilities as it
allows you to generate a complete project web site.  Lines 58-79
illustrate how you can configure Maven to produce a number of reports
including the dependency list, SCM information, information on the
project team, mailing lists and so on. The information for these reports
will be automatically collected and generated when you execute the <a
	href="http://maven.apache.org/plugins/maven-site-plugin/">maven-site-plugin</a>.
As well as incorporating reports you can also add your own web pages,
FAQs and complete navigation hierarchies into your own
generated project web site. An example Maven generated project web site
for the complete <a href="http://hoteldejava.sourceforge.net">HotelDeJava</a>
application is illustrated below:</p>
<p style="text-align: center;"><img
	src="%image_dir%/HotelDeJavaWeb-small.gif"
	alt="HotelDeJava project web site" style="width: 494px; height: 331px;" /></p>
<h2>Summary</h2>
<p>This article was intended as a rapid introduction to some of
Apache Maven's capabilities. Maven is a powerful and evolving too and in
comparison to Apache Ant has a number of distinct advantages. Its
foundation of plugins and goals should make it much easier to
maintain and implement new project build processes. Its dependency
capability is also a big advantage for more complex Java development
projects and its project website capability is unique. Some of these
capabilities could  be achieved with Ant, for example you can
implement re-usable routines using Ant's <span
	style="font-weight: bold;">import</span> and <span
	style="font-weight: bold;">macro</span> capabilities and you could use
<a href="http://jayasoft.org/">Apache Ivy</a> for dependency management.
However, Maven is still a very strong proposition for complex and
greenfield project build processes.</p>
<h2>References</h2>
<ul type="square">
	<li><a
		href="http://www.amazon.com/gp/product/0596007507?ie=UTF8&amp;tag=thebuildmeist-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0596007507">Maven:
	A Developer's Notebook (Developer's Notebooks)</a><img width="1" height="1"
		border="0"
		style="border: medium none ! important; margin: 0px ! important;"
		alt=""
		src="http://www.assoc-amazon.com/e/ir?t=thebuildmeist-20&amp;l=as2&amp;o=1&amp;a=0596007507" /></li>
	<li><a
		href="http://www.amazon.com/gp/product/0764556177?ie=UTF8&amp;tag=thebuildmeist-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0764556177">Professional
	Java Tools for Extreme Programming: Ant, XDoclet, JUnit, Cactus, and
	Maven (Programmer to Programmer)</a><img width="1" height="1" border="0"
		style="border: medium none ! important; margin: 0px ! important;"
		alt=""
		src="http://www.assoc-amazon.com/e/ir?t=thebuildmeist-20&amp;l=as2&amp;o=1&amp;a=0764556177" /></li>
	<li><a href="http://maven.apache.org/">Maven home page</a></li>
</ul>
</div>